{% from "bootstrap.html" import css, custom_css %}

<!DOCTYPE html>
<html lang="en">
  <body>
    <div class="container">
      <div class="card">
        <div class="card-block">
          <table class="table table-bordered" aria-describedby="Case table">
            <thead>
              <tr>
                <!-- <th>Prov</th> -->
                <!-- <th>Beställt</th> -->
                <!-- <th>Familj</th> -->
                <!-- <th>Kön</th> -->
                <!-- <th>Status</th> -->
                <!-- <th>Vävnad</th> -->
                <!-- <th>Ticket</th> -->
                <!-- <th>Applikation</th> -->
                <!-- <th>Bioinformatisk analys</th> -->
              </tr>
            </thead>
            <tbody>
              {% for sample in case.samples %}
                <tr>
                  <!-- <td>{{ sample.name }}* ({{ sample.id }})</td> -->
                  <!-- <td>{{ sample.timestamps.ordered_at }}</td> -->
                  <!-- <td>{{ case.name }}*</td> -->
                  <td>
                    <!-- {{ sample.gender }}* -->
                    {%  if sample.metadata.gender != 'N/A'%}
                      (analys:
                      {% if sample.gender != sample.metadata.gender %}
                        <span class="text-danger">{{ sample.metadata.gender }}</span>)
                      {% else %}
                        <span class="text-success">{{ sample.metadata.gender }}</span>)
                      {% endif %}
                    {% endif %}
                  </td>
                  <!-- <td>{{ sample.status }}*</td> -->
                  <!-- <td>{{ sample.source }}*</td> -->
                  <!-- <td>{{ sample.ticket }}</td> -->
                  <!-- <td>{{ sample.application.tag }}*</td> -->
                  <!-- <td>{{ case.data_analysis.customer_workflow }}*</td> -->
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <div class="card-block">
          <table class="table table-bordered" aria-describedby="Case table">
            <thead>
              <tr>
                <th>Prov</th>
                <th>Ankom</th>
                <th>Biblioteksberedning</th>
                <th>Beredd</th>
                <th>Bait set</th>
                <th>Sekvensering</th>
                <th>Sekvenserad</th>
                <th>Bioinformatisk analys</th>
              </tr>
            </thead>
            <tbody>
              {% for sample in case.samples %}
                <tr>
                  <td>{{ sample.name }}*</td>
                  <td>{{ sample.timestamps.received_at }}</td>
                  <td>{{ sample.methods.library_prep }}</td>
                  <td>{{ sample.timestamps.prepared_at }}</td>
                  <td>{{ sample.metadata.bait_set }}</td>
                  <td>{{ sample.methods.sequencing }}</td>
                  <td>{{ sample.timestamps.reads_updated_at }}</td>
                  <td>{{ case.data_analysis.workflow }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <div class="card-block">
          <table class="table table-bordered" aria-describedby="Case table">
            <thead>
              <tr>
                <th>Familj</th>
                <th>MIP-version</th>
                <th>Genpaneler</th>
                <th>Genomversion</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>{{ case.name }}*</td>
                <td>{{ case.data_analysis.workflow_version }}</td>
                <td>{{ case.data_analysis.panels }}</td>
                <td>{{ case.data_analysis.genome_build }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="card-block">
          <table class="table table-bordered" aria-describedby="Case table">
            <thead>
              <tr>
                <th>Prov</th>
                <th>Läspar [M]</th>
                <th>Mappade sekvenser [%]</th>
                <th>Medelsekvensdjup</th>
                <th>Täckningsgrad 10x [%]</th>
                <th>Duplikat [%]</th>
              </tr>
            </thead>
            <tbody>
              {% for sample in case.samples %}
                <tr>
                  <td>{{ sample.name }}*</td>
                  <td>{{ sample.metadata.million_read_pairs }}</td>
                  <td>{{ sample.metadata.mapped_reads }}</td>
                  <td>{{ sample.metadata.mean_target_coverage }}</td>
                  <td>{{ sample.metadata.pct_10x }}</td>
                  <td>{{ sample.metadata.duplicates }}</td>
                </tr>
              {% endfor %}
            </tbody>
            <caption>
              Resultat baserade på valda genpaneler: {{ case.data_analysis.panels }}.<br>
              <br>
              <strong>Förklaringar</strong><br>
              <ins>Läspar</ins>: Antal sekvenseringsläsningar i miljoner läspar.<br>
              <ins>Mappade sekvenser</ins>: Procent sekvenser som matchar en eller flera positioner i referensgenomet.<br>
              <ins>Medelsekvensdjup</ins>: Medelvärdet av täckningsgraden i baser över en genomisk region.<br>
              <ins>Täckningsgrad</ins>: Andel baser som är sekvenserade med ett djup över en specificerad gräns, t.ex. 100X.<br>
              <ins>Duplikat</ins>: Sekvenseringsläsningar som är duplikat (kopior) och därmed ej unika sekvenser. Hög mängd duplikat kan tyda på dålig komplexitet av sekvenserat bibliotek eller djup sekvensering.<br>
              <br>
              Värdena presenterade för <ins>Täckningsgrad</ins> är efter borttagning av duplikata läsningar.
            </caption>
          </table>

          <div class="card-body">* Information given av kund</div>

        </div>

        {% for application in case.applications %}
          <div class="card-block">
            <h4 class="card-title">
              Teknisk beskrivning av analysen: {{ application.tag }}
            </h4>
            <p class="card-text">{{ application.description }}</p>
            {% if application.details != 'N/A' %}
              <p class="card-text">{{ application.details }}</p>
            {% endif %}
            {% if application.limitations != 'N/A' %}
              <h4 class="card-title">
                Begränsningar av analysen: {{ application.tag }}
              </h4>
              <p class="card-text">{{ application.limitations }}</p>
              {% if application.workflow_limitations != 'N/A' %}
                <p class="card-text">{{ application.workflow_limitations }}</p>
              {% endif %}
            {% endif %}
          </div>
        {% endfor %}

        <div class="card-block">Laboratoriet har inte haft ansvar för provtagningsstadiet och extraktion, resultaten gäller för provet såsom det har mottagits. </div>
      </div>
    </div>
  </body>
</html>
